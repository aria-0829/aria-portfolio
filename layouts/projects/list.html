{{ define "main" }}
	{{ .Scratch.Set "scope" "list" }}
	{{ $enableToc := .Params.showTableOfContents | default (site.Params.list.showTableOfContents | default false) }}
	{{ $showToc := and $enableToc (in .TableOfContents "<ul") }}

	<header>
		{{ if .Params.showBreadcrumbs | default (site.Params.list.showBreadcrumbs | default false) }}
			{{ partial "breadcrumbs.html" . }}
		{{ end }}
		<h1 class="mt-5 text-4xl font-extrabold text-neutral-900 dark:text-neutral">{{ .Title }}</h1>
		<div class="mt-1 mb-2 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
			{{ partial "article-meta/list.html" (dict "context" . "scope" "single") }}
		</div>
	</header>

	{{ $tocMargin := cond $showToc "mt-12" "mt-0" }}
	{{ $topClass := cond (hasPrefix site.Params.header.layout "fixed") "lg:top-[140px]" "lg:top-10" }}
	<section class="{{ $tocMargin }} prose flex max-w-full flex-col dark:prose-invert lg:flex-row">
		{{ if $showToc }}
			<div class="order-first px-0 lg:order-last lg:max-w-xs lg:ps-8">
				<div class="toc ps-5 lg:sticky {{ $topClass }}">
					{{ partial "toc.html" . }}
				</div>
			</div>
		{{ end }}
		<div class="min-w-0 min-h-0 max-w-prose">
			{{ .Content }}
		</div>
	</section>

	<section class="space-y-12 w-full">
		{{ range (.Pages.ByTitle) }}
			<article class="project-section" id="{{ .Title | urlize }}">
				<h2 class="mt-12 text-2xl font-bold text-neutral-700 first:mt-8 dark:text-neutral-300">{{ .Title }}</h2>
				{{ partial "card/half-image-grey.html" . }}
			</article>
		{{ end }}

		{{/* Inject Games section */}}
		{{ $games := site.GetPage "section" "games" }}
		{{ with $games }}
			<article class="project-section" id="games">
				<h2 class="mt-12 text-2xl font-bold text-neutral-700 first:mt-8 dark:text-neutral-300">Games</h2>
				<section class="space-y-10 w-full">
					{{ range .Pages }}
						{{ partial "card/half-image-grey.html" . }}
					{{ end }}
				</section>
			</article>
		{{ end }}
	</section>

	{{ partial "pagination.html" . }}
{{ end }}
